###########################
Settings  and Customization
###########################

There are lots of ways that you can customize your Arches-HIP application to best suit your needs.  

Most of these will require comfort with modifying Python, HTML, CSS and/or Javascript files but are designed to be simple changes that can be easily applied without diving deep into the rest of the Arches or Arches-HIP code.

.. note:: In a production environment (using Apache), you will generally need to run ``collectstatic`` (https://docs.djangoproject.com/en/1.6/ref/contrib/staticfiles/#collectstatic) and restart Apache to apply these changes.

    No action should be required when using the development server (Django).

Home Page and Branding
======================

Modifying the home page and branding of your Arches-HIP application involves editing some simple HTML templates to modify the look and feel.  A basic familiarity with HTML and CSS is assumed here.

Your application starts with templates that you can use to start modifying the home page and branding of the web application.  These files are contained in the following folder::
    
    {application name}/{application name}/templates/

You can add your own CSS style rules (applied application wide) in the following file::

    {application name}/{application name}/media/css/package.css

**Home Page**

``index.htm`` contains the template for the main home page content.  You can modify this page to change the image slide show on the home page or modify the saved searches (more on that below).

This is the content of the first page that your users will see, so you'll probably want to really make it your own. You should consider doing the following:

* Update the images and text in the layer slider
* Add you own text to the title block below the layer slider
* Update the saved searches to suit your data (more on that below)

**Branding**

The templates that manage site-wide branding are ``footer.htm``, ``header.htm``, and ``copyright.htm``.  These templates are used by default for branding on all web application pages.

You should probably keep much of the structure of these templates, and simply input your own labels, icons and information as appropriate.

For example, the header logo on all pages can be altered by modifying the ``<img>`` tag at line 52 of ``header.htm``.  This will change the header image on all web application pages.

Saved Searches
==============

Saved searches are the links shown on the home and search pages by default to help users find data of particular interest.  You will need to update these to be useful for your application.

To do this, start by using the Arches-HIP web application search page to execute the search that you want to save.

For example, you could do a search for the word 'modern'.  You should see the page's URL update.  Copy everything after the ``?`` in the URL; you should get something like this::

    page=1&termFilter=%5B%7B%22inverted%22%3Afalse%2C%22type%22%3A%22string%22%2C%22context%22%3A%22%22%2C%22context_label%22%3A%22%22%2C%22id%22%3A%22modern%22%2C%22text%22%3A%22modern%22%2C%22value%22%3A%22modern%22%7D%5D&temporalFilter=%7B%22year_min_max%22%3A%5B%5D%2C%22filters%22%3A%5B%5D%2C%22inverted%22%3Afalse%7D&spatialFilter=%7B%22geometry%22%3A%7B%22type%22%3A%22%22%2C%22coordinates%22%3A%5B%5D%7D%2C%22buffer%22%3A%7B%22width%22%3A%220%22%2C%22unit%22%3A%22ft%22%7D%2C%22inverted%22%3Afalse%7D&mapExpanded=false&timeExpanded=false&include_ids=true

There are two html templates in your project that contain saved searches, these files are::

    {application name}/{application name}/templates/index.htm
    {application name}/{application name}/templates/views/saved-searches.htm

``index.htm`` contains the saved searches for the home page and ``saved-searches.htm`` contains the saved searches for the search page.

In both cases, you will find saved searches in blocks that look like this::

    <div class="col-sm-4">
        <div class="servive-block servive-block-default">
            <i class="icon-custom rounded-x icon-bg-dark fa fa-trophy"></i>
            <a class= "" href="{% url 'search_home' %}?"><h2 class="txt-color-blue">{% trans 'Saved Search' %}</h2></a>
            <p>{% trans 'Some description here...' %}</p>
        </div>
    </div>

To update that block to use the example search above for the word modern, I can simply update the label and description text and paste what I copied above after ``{% url 'search_home' %}?`` in the ``<a>`` tag's ``href`` attribute, for example::

    <div class="col-sm-4">
        <div class="servive-block servive-block-default">
            <i class="icon-custom rounded-x icon-bg-dark fa fa-trophy"></i>
            <a class= "" href="{% url 'search_home' %}?page=1&termFilter=%5B%7B%22inverted%22%3Afalse%2C%22type%22%3A%22string%22%2C%22context%22%3A%22%22%2C%22context_label%22%3A%22%22%2C%22id%22%3A%22modern%22%2C%22text%22%3A%22modern%22%2C%22value%22%3A%22modern%22%7D%5D&temporalFilter=%7B%22year_min_max%22%3A%5B%5D%2C%22filters%22%3A%5B%5D%2C%22inverted%22%3Afalse%7D&spatialFilter=%7B%22geometry%22%3A%7B%22type%22%3A%22%22%2C%22coordinates%22%3A%5B%5D%7D%2C%22buffer%22%3A%7B%22width%22%3A%220%22%2C%22unit%22%3A%22ft%22%7D%2C%22inverted%22%3Afalse%7D&mapExpanded=false&timeExpanded=false&include_ids=true"><h2 class="txt-color-blue">{% trans 'Modern' %}</h2></a>
            <p>{% trans 'Find things that are modern.' %}</p>
        </div>
    </div>

Google Analytics
================

To enable Google Analytics on your web application, you will need to update the ``GOOGLE_ANALYTICS_TRACKING_ID`` setting in your application's settings.py file (line 14 by default).

Uncomment this line (remove the starting ``#``) if it is commented, and paste in your own Google Analytics tracking id between the single quotes at the end of the line, eg::

    GOOGLE_ANALYTICS_TRACKING_ID = 'my-tracking-id'

Enabling this setting will automatically configure the web application to include the Google Analytics scripts.

Map Settings
============

Arches-HIP needs to be configured to properly zoom and constrain map interfaces by default.  This can be done by simply modifying some settings found in your application's ``settings.py`` file (line 15 by default)::
    
    #DEFAULT_MAP_X = 0
    #DEFAULT_MAP_Y = 0
    #DEFAULT_MAP_ZOOM = 0
    #MAP_MIN_ZOOM = 0
    #MAP_MAX_ZOOM = 19
    #MAP_EXTENT = '-13228037.69691764,3981296.0184014924,-13123624.71628009,4080358.407059081'

To use these settings, you will need to 'uncomment' them (remove the ``#`` at the start of each line), and then change their values to meet your needs.

``DEFAULT_MAP_X`` and ``DEFAULT_MAP_Y`` are the x and y (respectively) coordinate values which all maps will be centered on by default.  ``MAP_EXTENT`` is a string 'bounding box' [min x, min y, max x, max y] representing the extent to which all maps will be constrained.  

All of these coordinates are expressed in the web standard Spherical Mercator projection (http://spatialreference.org/ref/sr-org/6864/).  A simple converter tool to go between Lat/Long and Spherical Mercator coordinates can be found here: http://mal2.ch/stuff/latlontomercator.html

``DEFAULT_MAP_ZOOM`` is the default zoom level that all maps will start on.  ``MAP_MIN_ZOOM`` and ``MAP_MAX_ZOOM`` are the minimum and maximum zoom levels that all maps will allow a user to access.  More on zoom levels can be found here: http://openlayers.org/en/v3.3.0/doc/tutorials/concepts.html

By default, Arches-HIP will use Bing services for basemaps and geocoding; if you want to use these, you will need to get a Bing Maps Key (https://msdn.microsoft.com/en-us/library/ff428642.aspx) and add it to your ``settings.py`` file like so (by default at line 21)::
    
    BING_KEY = 'my-bing-key'

Basemaps
========

By default, Arches-HIP will supply the application with Bing layers as basemaps, but it is easy to add more basemap layers to Arches-HIP using OpenLayers.

The basemap layers are added in the following file::
    
    {application name}/{application name}/media/js/map/base-layers.js

You will notice that at the second to last line of this file, an array called ``baseLayers`` is returned::

    return baseLayers;

You can add more baseLayers by adding an object containing an OpenLayers 3 layer instance to this array before the return statement.

The objects you add should contain the following keys:

* ``id``: String; a unique id for this layer
* ``layer``: OpenLayers3 Layer; any valid OpenLayers 3 Layer instance, for more on OpenLayers 3 and layers see: http://openlayers.org/en/v3.3.0/doc/quickstart.html
* ``icon``: String; a valid path to an image used as an icon in the basemap list
* ``name``: String; a display name for this layer used in the basemap list

For example, I can add a tile layer as a basemap layer like so::

    baseLayers.push({
        id: 'mybasemap',
        name: 'My Tile Basemap',
        icon: arches.urls.media + 'img/map/my_basemap_icon.png',
        layer: new ol.layer.Tile({
            visible: false,
            source: new ol.source.XYZ({
                url: 'http://api.tiles.mapbox.com/v4/my-mapbox-map/{z}/{x}/{y}.png?access_token=my-access-token'
            })
        })
    });

    return baseLayers;

Overlays
========

Additional overlays can also be added to the Arches-HIP map interface.  This is quite similar to adding basemap layers except it is done in another file and requires a little extra metadata for each layer.

Overlays are added to the following file::

    {application name}/{application name}/media/js/map/layers.js

You will find, again, at the bottom of this file an array being returned, this one called ``layers``.  Additional overlay layers can be added to the ``layers`` array prior to the line where it is returned.  

However, in this case a little extra metadata is passed along with the layer instance in a Javascript object called a LayerModel.  The LayerModel is instantiated with an object with the following keys:

* ``layer``: OpenLayers3 Layer; any valid OpenLayers 3 Layer instance, for more on OpenLayers 3 and layers see: http://openlayers.org/en/v3.3.0/doc/quickstart.html
* ``icon``: String; a css class used for displaying an icon in the overlay list.  CSS rules can be added to ``package.css`` as described above
* ``name``: String; a display name for this layer used in overlay list
* ``description``: String; an optional description for the layer used in overlay list and for searching
* ``categories``: Array; an optional list of categories (Strings) used as keywords for layer search
* ``onMap``: Boolean; true to show this layer on the map by default

For example, you could add a tile layer overlay like so::

    layers.push(new LayerModel({
        name: 'My Tile Layer',
        categories: ['cool', 'fun'],
        description: 'My tile layer is very cool',
        icon: 'tile-layer-icon',
        layer: new ol.layer.Tile({
            source: new ol.source.XYZ({
                url: 'http://api.tiles.mapbox.com/v4/my-mapbox-map/{z}/{x}/{y}.png?access_token=my-access-token'
            })
        })
    }));

    return layers;

Resource Map Markers
====================

Resource map markers are shown in the web application using icon fonts for scalability and flexibility.

By default, support is provided for Octicons (https://octicons.github.com/) and Font Awesome (http://fortawesome.github.io/Font-Awesome/).

Arches-HIP provides some simple settings for managing how resource markers are displayed on the map.  These settings can be found in your ``settings.py`` file and should look something like this::
    
    RESOURCE_MARKER_ICON_UNICODE = '\uf060'
    RESOURCE_MARKER_ICON_FONT = 'octicons'
    RESOURCE_MARKER_DEFAULT_COLOR = '#C4171D'

These settings manage markers as follows:

* ``RESOURCE_MARKER_ICON_UNICODE``: the Unicode value of the icon you want to use
* ``RESOURCE_MARKER_ICON_FONT``: the font name you want to use ('octicons' or 'FontAwesome')
* ``RESOURCE_MARKER_DEFAULT_COLOR``: the hex value of the color you want to use by default

For example, if I wanted to symbolize my resource markers as pink Font Awesome house icons (http://fortawesome.github.io/Font-Awesome/icon/home/), I could adjust my settings like so::

    RESOURCE_MARKER_ICON_UNICODE = '\uf015'
    RESOURCE_MARKER_ICON_FONT = 'FontAwesome'
    RESOURCE_MARKER_DEFAULT_COLOR = '#F423FF'

Geocoding
=========


Localization
============

